<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>JUMLAH 2D → 2D OFF</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body class="bg-gray-50 text-gray-800">
  <div class="max-w-6xl mx-auto p-6">
    <h1 class="text-2xl font-bold mb-4">JUMLAH 2D → 2D OFF berdasarkan JUMLAH</h1>

    <!-- Card Input -->
    <div class="bg-white p-4 rounded shadow mb-6 card">
      <label class="block mb-2 font-medium">Input 2D ON (pisahkan dengan *):</label>
      <textarea id="inputOn" rows="3" class="w-full border rounded p-2 form-control" placeholder="contoh: 23*32*45*"></textarea>
      
      <label class="block mt-4 mb-2 font-medium">Pilih JUMLAH untuk OFF:</label>
      <select id="jumlahSelect" class="border rounded p-2 form-select">
        <option value="">-- Pilih JUMLAH --</option>
        <option value="JUMLAH 0">JUMLAH 0</option>
        <option value="JUMLAH 1">JUMLAH 1</option>
        <option value="JUMLAH 2">JUMLAH 2</option>
        <option value="JUMLAH 3">JUMLAH 3</option>
        <option value="JUMLAH 4">JUMLAH 4</option>
        <option value="JUMLAH 5">JUMLAH 5</option>
        <option value="JUMLAH 6">JUMLAH 6</option>
        <option value="JUMLAH 7">JUMLAH 7</option>
        <option value="JUMLAH 8">JUMLAH 8</option>
        <option value="JUMLAH 9">JUMLAH 9</option>
      </select>

      <div class="mt-3 flex gap-2">
        <button id="processBtn" class="btn btn-primary">Proses</button>
        <button id="resetBtn" class="btn btn-secondary">Reset</button>
      </div>
    </div>

    <!-- Card Output -->
    <div class="bg-white p-4 rounded shadow card">
      <h2 class="font-semibold mb-2">Tabel JUMLAH 2D & OFF</h2>
      <div class="overflow-x-auto">
        <table class="min-w-full border text-sm table table-bordered table-striped" id="jumlahTable">
          <thead class="bg-gray-100 table-dark">
            <tr>
              <th class="border px-2 py-1">JUMLAH</th>
              <th class="border px-2 py-1">Sisa 2D</th>
              <th class="border px-2 py-1">2D OFF (dihapus)</th>
              <th class="border px-2 py-1">Hasil 2D INPUT (valid)</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </div>

  <script>
    const ORIGINAL = {
      "JUMLAH 0": "02*06*17*19*20*28*29*33*37*46*48*55*56*59*60*64*65*66*67*71*73*76*77*78*82*84*87*88*91*92*95*99*",
      "JUMLAH 1": "00*02*03*06*13*17*20*28*30*31*39*44*48*57*59*60*66*67*71*75*76*77*78*82*84*87*88*89*93*95*98*99*",
      "JUMLAH 2": "00*04*06*09*11*13*14*17*24*28*31*39*40*41*42*55*59*60*68*71*77*78*82*86*87*88*89*90*93*95*98*99*",
      "JUMLAH 3": "00*01*04*06*09*10*11*15*17*22*24*25*28*35*39*40*42*51*52*53*60*66*71*79*82*88*89*90*93*97*98*99*",
      "JUMLAH 4": "00*01*04*08*09*10*11*12*15*17*21*22*26*28*33*35*36*39*40*46*51*53*62*63*64*71*77*80*82*90*93*99*",
      "JUMLAH 5": "00*01*04*10*11*12*15*19*21*22*23*26*28*32*33*37*39*40*44*46*47*51*57*62*64*73*74*75*82*88*91*93*",
      "JUMLAH 6": "02*04*11*12*15*20*21*22*23*26*32*33*34*37*39*40*43*44*48*51*55*57*58*62*68*73*75*84*85*86*93*99*",
      "JUMLAH 7": "00*04*13*15*22*23*26*31*32*33*34*37*40*43*44*45*48*51*54*55*59*62*66*68*69*73*79*84*86*95*96*97*",
      "JUMLAH 8": "06*07*08*11*15*24*26*33*34*37*42*43*44*45*48*51*54*55*56*59*60*62*65*66*70*73*77*79*80*84*95*97*",
      "JUMLAH 9": "06*08*17*18*19*22*26*35*37*44*45*48*53*54*55*56*59*60*62*65*66*67*71*73*76*77*80*81*84*88*91*95*"
    };

    let lists = {}, removed = {}, validInputs = {};

    function norm2d(s) {
      const d = (s || "").replace(/\D/g, "");
      if (!d) return null;
      return d.padStart(2, "0").slice(-2);
    }

    function loadOriginal() {
      lists = {};
      removed = {};
      validInputs = {};
      for (const key in ORIGINAL) {
        lists[key] = ORIGINAL[key].split("*").map(norm2d).filter(Boolean);
        removed[key] = [];
        validInputs[key] = [];
      }
    }

    function renderTable() {
      const tbody = document.querySelector("#jumlahTable tbody");
      tbody.innerHTML = "";
      for (const key in lists) {
        const sisaSorted = [...lists[key]].sort((a, b) => parseInt(a) - parseInt(b));
        const removedSorted = [...removed[key]].sort((a, b) => parseInt(a) - parseInt(b));
        const validSorted = [...validInputs[key]].sort((a, b) => parseInt(a) - parseInt(b));

        const row = document.createElement("tr");
        row.innerHTML = `
          <td class="border px-2 py-1 font-medium">${key}</td>
          <td class="border px-2 py-1 text-xs">${sisaSorted.join(" ") || "-"}</td>
          <td class="border px-2 py-1 text-xs text-danger">
            ${removedSorted.join("*") || "-"}
            ${removedSorted.length ? `<div class="text-muted">Jumlah: ${removedSorted.length}</div>` : ""}
          </td>
          <td class="border px-2 py-1 text-xs text-success">
            ${validSorted.join("*") || "-"}
            ${validSorted.length ? `<div class="text-muted">Jumlah: ${validSorted.length}</div>` : ""}
            ${validSorted.length ? `<button onclick="copyText('${validSorted.join('*')}')" class="btn btn-sm btn-outline-secondary mt-1">Salin</button>` : ""}
          </td>
        `;
        tbody.appendChild(row);
      }
    }

    function processInput(txt, jumlahKey) {
      const nums = txt.split("*").map(norm2d).filter(Boolean);
      for (const num of nums) {
        const idx = lists[jumlahKey].indexOf(num);
        if (idx >= 0) {
          removed[jumlahKey].push(lists[jumlahKey][idx]);
          lists[jumlahKey].splice(idx, 1);
        } else {
          validInputs[jumlahKey].push(num);
        }
      }
    }

    function copyText(text) {
      navigator.clipboard.writeText(text).then(() => {
        alert("Teks berhasil disalin: " + text);
      });
    }

    document.getElementById("processBtn").onclick = () => {
      const val = document.getElementById("inputOn").value.trim();
      const jumlahKey = document.getElementById("jumlahSelect").value;
      if (!val) { alert("Isi angka 2D ON dulu."); return; }
      if (!jumlahKey) { alert("Pilih JUMLAH dulu."); return; }
      processInput(val, jumlahKey);
      renderTable();
    };

    document.getElementById("resetBtn").onclick = () => {
      loadOriginal();
      renderTable();
    };

    loadOriginal();
    renderTable();
  </script>
</body>
</html>
